[toc]

## 一、Linux 概述

Linux 下一切皆文件

### Linux 的目录结构

![Linux目录结构](https://www.runoob.com/wp-content/uploads/2014/06/d0c50-linux2bfile2bsystem2bhierarchy.jpg)

- /bin：binary，这个目录存放二进制可执行文件，包括一些经常使用的命令。

- /boot：存放启动 Linux 时使用的一些核心文件

- /dev：device，存放 Linux 的外部设备（键盘、鼠标...）

- /etc：etcetera（等等） ，存放系统的全局配置文件

- /home：家目录，每个用户都有一个自己的目录

- /lib：library：存放类库

- /lost + found：一般是空的，当系统非法关机后，这里会存放一些文件

- /media：Linux 会自动识别一些设备，例如 U 盘，识别后会把识别的设备挂载到这个目录下

- /mnt：mount，让用户临时挂载别的文件系统，可以将光驱挂载到 /mnt 上，进入该目录就可以查看光驱的内容了

- opt：optional（可选），这是一个额外安装软件时可以存放的目录位置，用的比较少

- /proc：process（进程），存储当前运行状态下进程相关的文件，在 Linux 下一切皆文件，我们可以查看

- /root：系统管理员目录

- /sbin：superuser binaray，存放系统管理员使用的系统管理程序

- /srv：存放一些服务启动后需要提取的数据

- /sys：这是 Linux2.6 内核的一个很大的变化。该目录下安装了 2.6 内核中新出现的一个文件系统 sysfs 。

  sysfs 文件系统集成了下面3种文件系统的信息：针对进程信息的 proc 文件系统、针对设备的 devfs 文件系统以及针对伪终端的 devpts 文件系统。

  该文件系统是内核设备树的一个直观反映。

  当一个内核对象被创建的时候，对应的文件和目录也在内核对象子系统中被创建。

- /tmp：temp，临时文件，隔一段时间之后会定时删除，和配置相关

- /usr：unix shared resources（共享资源），用户很多应用程序和文件都存放瞎这个目录下，类似于 Windows 下的 Program files 目录

- /usr/bin：系统用户使用的应用程序目录

- /usr/sbin：超级用户使用的管理程序和守护程序目录

- /usr/src：存放内核源代码

- /var：variable（变量），变量指的是这个目录下内容的大小是不固定的，一般系统运行过程中一些内容会放在这里（比如日志文件），我们习惯将一些经常被修改的文件放在这个目录下

- /run：临时文件系统，存储系统启动以来的信息，当系统重启后这个目录下的文件就被删除了

### 文件的基本属性

![Linux 文件属性](https://www.runoob.com/wp-content/uploads/2014/06/file-llls22.jpg)

![Linux文件属性](https://www.runoob.com/wp-content/uploads/2014/06/363003_1227493859FdXT.png)

每个文件的属性由左边第一部分 10 个字符来确定

`0`：d 表示一个目录文件，- 表示一个文件，l 表示链接文件

`1~3`：表示属主（该文件的所有者）拥有该文件的权限

`4~6`：表示属组（所属的用户组）拥有该文件的权限

`7~9`：表示其他用户拥有该文件的权限

三组权限中每一个组都是由三个位置组成，依次的含义是 `r`(readable, 可读) `w`(writeable，可写) `x`(excuteable，可执行)，`-`表示没有权限

可以使用 chmod 命令更改文件的权限，比如 770 则代表 rwxrwx---，即当前用户和当前用户所属的组对该文件都有可读可写可执行的权限

```bash
chmod [-R] 770 file/dir  # R 表示递归添加权限，如果是对目录添加权限，则它下面所有文件或子目录都会被添加权限
```



查看命令帮助文档

- `man 命令`
- `命令 --help`

## 二、文件和目录管理

### 文件和目录的基本操作

#### 1. ls（list files）列出所有目录

- -a：all，列出全部的文件，包含隐藏文件
- -d：仅列出目录 
- -l：long，以长数据串行列出，列出文件的详细信息

`ll = ls -l`

`ls -al`  表示列出所有文件（包含隐藏文件）的详细信息

#### 2. cd（change directory） 切换目录

```
. 是当前目录
.. 是上一层目录
cd 要切换的目录（可以是绝对路径，也可以是相对路径）
```

#### 3. pwd（print work directory）显示当前所在目录

#### 4. mkdir（make directory）创建一个新的目录

`mkdir [-mp] 目录名称`

- -m：配置文件目录的权限，目录的默认权限是 rwxr--r--，文件的默认权限 `rw-r--r--`（文件默认不可执行）

  `mkdir -m 770 test.txt`

- -p：递归创建目录

  `mkdir -p /test1/test2/test3`

#### 5. rmdir（remove directory）删除一个空的目录

`rmdir [-p] 目录名称`

- -p：递归删除目录

#### 6. cp（copy file）复制文件或目录

`cp [-] 源 目标`

#### 7. rm（remove）删除文件或目录

`rm [-fir] 文件或目录`

- -f：force，强制删除
- -i：删除前询问
- -r：递归删除目录下的所有内容

`rm -rf 目录`：递归强制所有目录下的所有内容

#### 8. mv（move file）移动文件目录 / 修改文件与目录的名称

`mv [-fiu] 源 目标`

- -f：强制移动，如果文件已存在，直接覆盖
- -i：如果文件已存在，询问是否覆盖
- -u：若目标文件已经存在，且 source 比较新，才会升级 (update)

### 查看文件内容

#### 1. cat

查看文件内容

#### 2. tac

cat 的反操作，从最后一行开始打印

#### 3. nl

显示内容的时候显示行号

`nl test.txt`

#### 4. more

一页一页显示文件内容，

`空格` 显示下一页

`Enter` 显示下一行

`q` 退出 more

不可以搜索

#### 5. less

与 more 类似，但 less 可以向前翻页

PageUp 向上翻页，PageDown / 空格 向下翻页

`/字符串` 向下搜索字符串并高亮显示，通过 n 和 N 上下移动

`?字符串`向上搜索字符串并高亮显示，通过 n 和 N 上下移动

#### 6. head

只看头几行 `head [-n 行号] 文件`

默认情况下只显示前 10 行

#### 7. tail

只看最后几行 `tail [-n 行号] 文件`

默认情况下只显示后 10 行

### 链接

#### 1. 实体链接（硬链接）

默认情况下，**ln** 命令产生硬链接。`In f1 f2`，那么 f2 就是 f1 的硬链接，删除 f1 后，f2 还在

#### 2. 符号链接（软链接）

使用 `In -s f1 f3` 为 f1 创建一个软链接 f3，删除 f3 后，f1 也没了

## 三、用户和用户组管理

### 用户管理

与用户相关的系统文件：/etc/passwd 和 /etc/shadow，每个用户在 /etc/passwd 中都有一个对应的记录，记录了这个用户的一些基本属性，在这个文件中口令是不可见的，/etc/shadow 是口令加密后的文件

#### 1. 添加用户

`useradd [-] 用户名`

- -g：指定用户所属的用户组

- -d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。

  `useradd -d /home/tonngw -m tonngw`

#### 2. 修改用户

`usermod [-] 用户名`

和 useradd 的参数一样

#### 3. 删除用户

`userdel [-r] 用户名`

- -r：将递归用户的主目录删除

#### 4. 用户口令（密码）管理

`passwd [-] 用户名`

- -l：锁定口令，禁用帐号
- -u：口令解锁
- -d：使帐号无口令

如果只输入 `passwd` 则默认是修改当前用户的口令

如果是 root 用户，输入 `passwd 用户名` 则可以为当前用户指定口令

### 用户组管理

与用户组相关的系统文件：/etc/group

#### 1. 添加用户组

`groupadd [-] 用户组`

- -g：指定新用户组的标识号，默认从 1000 开始递增，如果不指定标识号，默认以当最大标识号基础上加 1

`groupadd -g 101 group2`：此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101。

#### 2. 修改用户组

`groupmod [-] 用户组`

- -g：指定用户组的新标识号
- -n：修改用户组的名字

`groupmod –g 10000 -n group3 group2`：此命令将组group2的标识号改为10000，组名修改为group3。

#### 3. 删除用户组

`groupdel 用户组`

## 四、磁盘管理

磁盘管理的三个命令

#### 1. df（disk full）

列出文件系统整体磁盘的使用量

- -a：列出所有的文件系统
- -h：以容易阅读的单位形式 M、G 显示，默认是字节

`df -ah` 

#### 2. du（disk used）

查看对文件和目录磁盘的空间使用量

和 df 的参数类似

- -a：列出所有的文件与目录容量，默认仅统计当前目录下的使用量
- -h：以容易阅读的单位形式 M、G 显示，默认是字节

`du -ah`

#### 3. fdisk

用于磁盘分区

## 五、进程管理

### 查看进程

#### 1. ps

查看每个时间点的进程信息

`ps -`：查看自己的进程

`ps -aux`：查看所有的进程

- -a：显示当前终端所有的进程信息
- -u：以用户的信息显示进程
- -x：显示后台运行进程的参数

`ps aux | grep mysql `：查看特定的进程

#### 2. pstree

查看进程树

`pstree -A`：查看所有的进程树

#### 3. top

实时显示进程信息

`top -d 2` 两秒钟刷新一次

#### 4. netstat

查看占用端口的进程

`netstat -anp | grep port`

### 结束进程

#### 5. kill

杀死进程

`kill -9 进程 id` 

## 六、压缩与打包

### 压缩扩展名

常见的压缩扩展名，根据扩展名可以知道压缩工具

| 扩展名    | 压缩程序                              |
| --------- | ------------------------------------- |
| *.Z       | compress                              |
| *.zip     | zip                                   |
| *.gz      | gzip                                  |
| *.bz2     | bzip2                                 |
| *.xz      | xz                                    |
| *.tar     | tar 程序打包的数据，没有经过压缩      |
| *.tar.gz  | tar 程序打包的文件，经过 gzip 的压缩  |
| *.tar.bz2 | tar 程序打包的文件，经过 bzip2 的压缩 |
| *.tar.xz  | tar 程序打包的文件，经过 xz 的压缩    |

### 压缩指令

使用对应的压缩工具进行压缩即可

### 打包并压缩（常用）

压缩指令只能对一个文件进行压缩，而打包可以将多个文件打包成一个大文件。tar 不仅可以用于打包，也可以使用 gzip、bzip2、xz 将打包文件进行压缩

```
tar [-z|-j|-J] [cv] [-f 新建的 tar 文件] filename...  ==打包压缩
tar [-z|-j|-J] [tv] [-f 已有的 tar 文件]              ==查看
tar [-z|-j|-J] [xv] [-f 已有的 tar 文件] [-C 目录]    ==解压缩

-z ：使用 gzip；
-j ：使用 bzip2；
-J ：使用 xz；
-c ：新建打包文件；
-t ：查看打包文件里面有哪些文件；
-x ：解打包或解压缩的功能；
-v ：在压缩/解压缩的过程中，显示正在处理的文件名；
-f : filename：要处理的文件；
-C 目录 ： 在特定目录解压缩。
```

| 含义     | 命令                                               |
| -------- | -------------------------------------------------- |
| 打包压缩 | tar -zcvf filename.tar.gz 要被压缩的文件或目录名称 |
| 查看     | tar -ztvf filename.tar.gz                          |
| 解压缩   | tar -zxvf filename.tar.gz -C 要解压的目录          |

## 软件安装

### yum

### apt-get

### rpm

## VIM

![vim-cheat-sheet-cn](./pics/vim-cheat-sheet-cn.gif)

![vim-cheat-sheet-en](./pics/vim-cheat-sheet-en.gif)使用 vim 打开一个文件：vim test.txt，打开之后默认是 Normal 模式，在 Normal 模式可以按 : 输入命令，按 i 进入 Insert 模式，ESC 回到 Normal 模式，按 `v、Shift + v 或 Ctrl+ + v` 进入 Visual 模式。`:wq` 保存并退出 Vim

Vim 操作文件内容有一个原则：`<operation> <motion>` 操作 + 动作

方向键：h j k l 左 下 上 右

复制：y，后面跟表示操作范围的指令，y3h 表示复制左边三个字符，yy/Y 表示复制一整行

粘贴：p 在后面粘贴，P 在前面粘贴

修改：c， 后面跟表示操作范围的指令，cw 表示修改当前单词

替换

- 替换字符：r 替换当前字符，R 进入替换模式
- 行内替换：`:/s/要搜索的字符串/要替换的字符串/g` g 表示全局
- 全文替换：`:%s/要搜索的字符串/要替换的字符串/g`

删除：x 删除当前字符（向后删），X 向前删，

插入：i 当前光标前插入，a 当前光标后插入，I 行首插入，A 行末插入，o 插入一行，O 在上面插入一行

查找：f 行内查找，F 行内反向查找

撤销：u 可以一直撤销，`Ctrl + r` 取消撤销

跳转

- 行内跳转：0 跳转到行头，$ / g_ 跳转到行尾
- 单词跳转：w 跳转到下一个单词开头，e 跳转到下一个单词末尾，b 跳转到上一个单词开头，W、E、B 跳转时按空格来区分一个单词，w、e、b 按特殊符号来区分一个单词
- 全文跳转：gg 回到第一行，G 跳转到最后一行，Ctrl + d 向下翻页，Ctrl + u 向上翻页

全文搜索：/字符串，向下搜索字符串，并高亮显示，?字符串，向上搜索字符串，按 n 匹配下一个，N 匹配上一个

可视模式下的批量操作：`Ctrl + v` 选择多行内容，按 I 在第一行插入内容，按 ESC 即可完成批量操作

其他

- `.` 重复上一次的操作

SSH 连接远程服务器

`ssh root@ip地址`

输入密码

